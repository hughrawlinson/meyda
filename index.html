<!DOCTYPE html>
<html>
<head>
	<title>Meyda</title>
	<script type="text/javascript" src="main.js"></script>
	<meta charset="UTF-8">
</head>
<body>
	<audio src="test.mp3" id="tune" controls></audio>
	<script>

		var tune = document.getElementById('tune');
		tune.oncanplaythrough = function (e) {
			console.log("audio loaded");
			init();
			tune.play();
		}

		// callback for mic position
		function init() {
			// polyfill
			window.AudioContext = window.AudioContext || window.webkitAudioContext;
			var context = new AudioContext();

			// create audionode from mic
			window.source = context.createMediaElementSource( tune );

			// instantiate new medya
			var m = new Meyda(context,source,256);

			document.body.onkeydown = function() {
				tune.play();
				m.get("normalisedSpectrum");
				//console.log(m.get(["spectrum","normalisedSpectrum"]));
			}
		}
	</script>
</body>
</html>